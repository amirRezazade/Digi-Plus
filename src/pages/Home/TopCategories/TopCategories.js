import { useEffect, useState } from "react";
import { Swiper, SwiperSlide } from "swiper/react";
import TopCategoriesBtn from "./TopCategoriesBtn";
import ProductCart from "../../../component/carts/ProductCart";
import { FreeMode } from "swiper/modules";
import { Link } from "react-router-dom";

import "swiper/css";
import "swiper/css/free-mode";

export default function TopCategories() {
  let [category, setCategory] = useState("womens-watches,mens-watches");
  let [products, setProducts] = useState([]);
  let [loading, setLoading] = useState(false);
  let categories = [
    {
      name: "ساعت ",
      id: "womens-watches,mens-watches",
      icon: (
        <svg xmlns="http://www.w3.org/2000/svg" width="15" height="18" viewBox="0 0 15 18" fill="currentcolor">
          <path d="M4.58333 0C3.61719 0 2.83333 0.755859 2.83333 1.6875V3.9375H2.86979C1.4151 5.175 0.5 6.98555 0.5 9C0.5 11.0145 1.4151 12.825 2.86979 14.0625H2.83333V16.3125C2.83333 17.2441 3.61719 18 4.58333 18H10.4167C11.3828 18 12.1667 17.2441 12.1667 16.3125V14.0625H12.1302C13.5849 12.825 14.5 11.0145 14.5 9C14.5 6.98555 13.5849 5.175 12.1302 3.9375H12.1667V1.6875C12.1667 0.755859 11.3828 0 10.4167 0H4.58333ZM2.25 9C2.25 8.33518 2.3858 7.67688 2.64963 7.06266C2.91347 6.44845 3.30018 5.89037 3.78769 5.42027C4.2752 4.95018 4.85395 4.57727 5.49091 4.32286C6.12787 4.06845 6.81056 3.9375 7.5 3.9375C8.18944 3.9375 8.87213 4.06845 9.50909 4.32286C10.146 4.57727 10.7248 4.95018 11.2123 5.42027C11.6998 5.89037 12.0865 6.44845 12.3504 7.06266C12.6142 7.67688 12.75 8.33518 12.75 9C12.75 9.66482 12.6142 10.3231 12.3504 10.9373C12.0865 11.5515 11.6998 12.1096 11.2123 12.5797C10.7248 13.0498 10.146 13.4227 9.50909 13.6771C8.87213 13.9316 8.18944 14.0625 7.5 14.0625C6.81056 14.0625 6.12787 13.9316 5.49091 13.6771C4.85395 13.4227 4.2752 13.0498 3.78769 12.5797C3.30018 12.1096 2.91347 11.5515 2.64963 10.9373C2.3858 10.3231 2.25 9.66482 2.25 9ZM8.375 6.1875C8.375 5.71992 7.9849 5.34375 7.5 5.34375C7.0151 5.34375 6.625 5.71992 6.625 6.1875V9C6.625 9.28125 6.77083 9.54492 7.0151 9.70312L8.7651 10.8281C9.16615 11.0883 9.70937 10.9828 9.97917 10.5926C10.249 10.2023 10.1396 9.68203 9.7349 9.42188L8.375 8.55V6.1875Z"></path>
        </svg>
      ),
    },
    {
      name: "لپتاپ و اولترابوک",
      id: "laptops",
      icon: (
        <svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 19 14">
          <path d="M14.9 2.1875H4.1C3.8525 2.1875 3.65 2.38437 3.65 2.625V8.75H2.3V2.625C2.3 1.65977 3.10719 0.875 4.1 0.875H14.9C15.8928 0.875 16.7 1.65977 16.7 2.625V8.75H15.35V2.625C15.35 2.38437 15.1475 2.1875 14.9 2.1875ZM3.2 11.8125H15.8C16.3878 11.8125 16.8884 11.4461 17.0741 10.9375H1.92594C2.11156 11.4461 2.61219 11.8125 3.2 11.8125ZM0.5 10.5C0.5 10.016 0.902187 9.625 1.4 9.625H17.6C18.0978 9.625 18.5 10.016 18.5 10.5C18.5 11.9492 17.2906 13.125 15.8 13.125H3.2C1.70938 13.125 0.5 11.9492 0.5 10.5Z"></path>
        </svg>
      ),
    },
    {
      name: "گوشی هوشمند",
      id: "smartphones",
      icon: (
        <svg xmlns="http://www.w3.org/2000/svg" width="13" height="16" viewBox="0 0 13 16" fill="currentcolor">
          <path d="M3 1.5C2.725 1.5 2.5 1.725 2.5 2V14C2.5 14.275 2.725 14.5 3 14.5H10C10.275 14.5 10.5 14.275 10.5 14V2C10.5 1.725 10.275 1.5 10 1.5H3ZM1 2C1 0.896875 1.89688 0 3 0H10C11.1031 0 12 0.896875 12 2V14C12 15.1031 11.1031 16 10 16H3C1.89688 16 1 15.1031 1 14V2ZM5.5 12.5H7.5C7.775 12.5 8 12.725 8 13C8 13.275 7.775 13.5 7.5 13.5H5.5C5.225 13.5 5 13.275 5 13C5 12.725 5.225 12.5 5.5 12.5Z"></path>
        </svg>
      ),
    },

    {
      name: "لوازم ورزشی",
      id: "sports-accessories",
      icon: (
        <svg xmlns="http://www.w3.org/2000/svg" width="17" height="16" viewBox="0 0 17 16" fill="currentcolor">
          <path d="M10 14.325C10 14.3 10 14.275 10 14.25C10 13.2094 10.3344 12.2469 10.9031 11.4625L12.5344 13.0938C11.8 13.675 10.9406 14.1 10 14.325ZM8.50625 14.5C8.50313 14.5 8.50313 14.5 8.5 14.5C6.975 14.5 5.57188 13.975 4.46563 13.0969L8.5 9.05937L9.83125 10.3906C8.99687 11.4563 8.5 12.7937 8.5 14.25C8.5 14.3344 8.50313 14.4156 8.50625 14.5ZM10.8938 9.33125L9.55937 8L13.5969 3.96563C14.475 5.07188 15 6.475 15 8C15 8.00313 15 8.00313 15 8.00625C14.9156 8.00313 14.8344 8 14.75 8C13.2937 8 11.9563 8.49687 10.8938 9.33125ZM14.825 9.5C14.6031 10.4406 14.175 11.3031 13.5938 12.0344L11.9625 10.4031C12.7437 9.83437 13.7094 9.5 14.75 9.5C14.775 9.5 14.8 9.5 14.825 9.5ZM8.5 6.94063L7.16875 5.60938C8.00312 4.54375 8.5 3.20625 8.5 1.75C8.5 1.66562 8.49688 1.58438 8.49375 1.5C8.49688 1.5 8.49687 1.5 8.5 1.5C10.025 1.5 11.4281 2.025 12.5344 2.90313L8.5 6.94063ZM6.09688 4.5375L4.46563 2.90313C5.2 2.32188 6.05937 1.89688 7 1.67188C7 1.69687 7 1.72188 7 1.74688C7 2.7875 6.66563 3.75 6.09688 4.53438V4.5375ZM5.0375 5.59688C4.25312 6.16563 3.29063 6.5 2.25 6.5C2.225 6.5 2.2 6.5 2.175 6.5C2.39687 5.55937 2.825 4.69688 3.40625 3.96563L5.0375 5.59688ZM2 7.99375C2.08438 7.99688 2.16562 8 2.25 8C3.70625 8 5.04375 7.50312 6.10625 6.66875L7.44063 8L3.40313 12.0344C2.525 10.9281 2 9.525 2 8C2 7.99687 2 7.99688 2 7.99375ZM8.5 16C10.6217 16 12.6566 15.1571 14.1569 13.6569C15.6571 12.1566 16.5 10.1217 16.5 8C16.5 5.87827 15.6571 3.84344 14.1569 2.34315C12.6566 0.842855 10.6217 0 8.5 0C6.37827 0 4.34344 0.842855 2.84315 2.34315C1.34285 3.84344 0.5 5.87827 0.5 8C0.5 10.1217 1.34285 12.1566 2.84315 13.6569C4.34344 15.1571 6.37827 16 8.5 16Z"></path>
        </svg>
      ),
    },
    {
      name: "مردانه",
      id: "mens-shirts,mens-shoes",
      icon: (
        <svg xmlns="http://www.w3.org/2000/svg" width="19" height="14" viewBox="0 0 19 14" fill="currentcolor">
          <path d="M17.5014 4.13984L17.9317 3.63672L17.4986 4.13984H17.5014ZM14.7733 7.23516L14.343 7.73828L14.7761 7.23516H14.7733ZM13.3249 6.06211L13.758 5.55898C13.5555 5.39492 13.2771 5.36211 13.0408 5.46875C12.8046 5.57539 12.6527 5.80781 12.6527 6.06211H13.3277H13.3249ZM5.67487 6.06211H6.34987C6.34987 5.80781 6.19799 5.57539 5.96174 5.46875C5.72549 5.36211 5.44424 5.39492 5.24456 5.55898L5.67487 6.06211ZM2.97206 7.13945L2.46581 7.57148L2.97487 7.13945H2.97206ZM7.73362 0.779297C7.65206 0.371875 7.28643 0 6.77737 0V1.3125C6.55799 1.3125 6.43425 1.15664 6.40893 1.03086L7.73362 0.776563V0.779297ZM9.49987 2.1875C8.62518 2.1875 7.89675 1.58047 7.73362 0.779297L6.40893 1.03359C6.693 2.43906 7.96987 3.5 9.49987 3.5V2.1875ZM11.2661 0.779297C11.103 1.58047 10.3746 2.1875 9.49987 2.1875V3.5C11.0299 3.5 12.3067 2.43906 12.5908 1.03086L11.2661 0.776563V0.779297ZM12.2224 0C11.7105 0 11.3477 0.371875 11.2661 0.779297L12.5908 1.03359C12.5655 1.15664 12.4417 1.3125 12.2224 1.3125V0ZM14.3824 0.760156C13.7777 0.267969 13.0127 0 12.2224 0V1.3125C12.6949 1.3125 13.1561 1.47383 13.5189 1.76914L14.3824 0.760156ZM17.9317 3.63672L14.3852 0.760156L13.5189 1.76914L17.0683 4.6457L17.9317 3.63672ZM18.4942 4.69219C18.4605 4.28203 18.258 3.89922 17.9317 3.63672L17.0683 4.6457C17.1161 4.68398 17.1442 4.73867 17.1499 4.79609L18.4971 4.69219H18.4942ZM18.1089 5.82148C18.3874 5.50977 18.528 5.10508 18.4942 4.69219L17.1499 4.79609C17.1555 4.85352 17.1358 4.91367 17.0936 4.95742L18.1089 5.82148ZM16.5339 7.57148L18.1089 5.82148L17.0936 4.95742L15.5186 6.70742L16.5339 7.57148ZM14.3402 7.73828C14.9983 8.27148 15.9714 8.19492 16.5339 7.57148L15.5186 6.70742C15.4371 6.79766 15.2992 6.80859 15.2064 6.73203L14.343 7.73828H14.3402ZM12.8917 6.56523L14.343 7.73828L15.2064 6.7293L13.758 5.55625L12.8946 6.56523H12.8917ZM12.6499 6.06211V12.25H13.9999V6.06211H12.6499ZM12.6499 12.25C12.6499 12.4906 12.4474 12.6875 12.1999 12.6875V14C13.1927 14 13.9999 13.2152 13.9999 12.25H12.6499ZM12.1999 12.6875H6.79987V14H12.1999V12.6875ZM6.79987 12.6875C6.55237 12.6875 6.34987 12.4906 6.34987 12.25H4.99987C4.99987 13.2152 5.80706 14 6.79987 14V12.6875ZM6.34987 12.25V6.06211H4.99987V12.25H6.34987ZM4.65956 7.73828L6.10799 6.56523L5.24456 5.55625L3.79612 6.7293L4.65956 7.73828ZM2.46581 7.57148C3.02831 8.19766 4.00143 8.27148 4.65956 7.73828L3.79612 6.7293C3.70331 6.80586 3.56268 6.79492 3.48393 6.70469L2.46581 7.57148ZM0.890807 5.82148L2.46581 7.57148L3.48112 6.70742L1.90612 4.95742L0.890807 5.82148ZM0.505495 4.69219C0.471745 5.10234 0.609557 5.50977 0.890807 5.82148L1.90612 4.95742C1.86674 4.91367 1.84706 4.85625 1.84987 4.79609L0.505495 4.69219ZM1.06799 3.63672C0.741745 3.90195 0.539245 4.28203 0.505495 4.69219L1.84987 4.79609C1.85549 4.73867 1.88362 4.68398 1.93143 4.6457L1.06518 3.63672H1.06799ZM4.61456 0.760156L1.06518 3.63672L1.92862 4.6457L5.48081 1.76914L4.61456 0.760156ZM6.77737 0C5.98706 0 5.22206 0.267969 4.61737 0.760156L5.48081 1.76914C5.84362 1.47383 6.30206 1.3125 6.77737 1.3125V0Z"></path>
        </svg>
      ),
    },
    {
      name: "زنانه",
      id: "womens-dresses,tops,womens-shoes",
      icon: (
        <svg version="1.1" id="Capa_1" width="18" height="18" viewBox="0 0 479.154 479.154">
          <g id="SVGRepo_bgCarrier" strokeWidth="0"></g>
          <g id="SVGRepo_tracerCarrier" strokeLinecap="round" strokeLinejoin="round"></g>
          <g id="SVGRepo_iconCarrier">
            <g>
              <g>
                <path d="M372.525,444.712c6.296-4.845,11.629-5.326,17.925-5.326c6.292,0,9.69-3.398,9.69-10.175 c0-6.784,11.621-0.489,7.742-9.689c-3.879-9.201-17.433-35.358-25.183-58.128c-7.742-22.763-18.883-67.325-28.092-89.113 c-9.197-21.797-60.54-111.4-68.283-131.263c-7.75-19.861,10.348-55.697,10.348-55.697s6.043-33.781,7.137-37.964 c0.401-1.533-0.941-3.212-2.781-4.733c2.325-1.477,3.964-3.955,3.964-6.909c0-1.194-0.276-2.318-0.722-3.338 c1.006-1.373,1.72-2.982,1.72-4.817c0-0.024-0.017-0.05-0.017-0.074c6.532-0.344,4.164-2.871,12.916-7.918 c9.445-5.452,0.729-3.998,1.459-9.806c0.729-5.811-3.267-6.538-5.811-9.085c-2.545-2.541-5.45,2.907-5.45,2.907 c-14.888-0.733-2.541,11.257-9.807,10.195c-3.41-0.501-4.348,2.53-3.559,5.856c-3.635,0.92-6.371,4.046-6.371,7.939 c0,1.192,0.276,2.316,0.721,3.336c-1.002,1.37-1.715,2.981-1.715,4.821c0,0.062,0.027,0.108,0.027,0.172 c-1.915-0.165-3.915,0.617-4.98,4.144c0,0-5.566-3.557-7.995,2.817c0,0-7.991-0.399-9.201,6.628c0,0-22.024-0.457-26.633,5.769 c-4.606-6.226-26.637-5.769-26.637-5.769c-1.206-7.027-9.199-6.628-9.199-6.628c-2.426-6.382-7.993-2.817-7.993-2.817 c-1.068-3.526-3.07-4.3-4.981-4.144c0-0.064,0.03-0.11,0.03-0.172c0-1.839-0.717-3.442-1.721-4.821 c0.457-1.028,0.724-2.144,0.724-3.336c0-3.893-2.747-7.019-6.366-7.922c0.793-3.329-0.142-6.36-3.559-5.853 c-7.259,1.066,5.087-10.92-9.804-10.201c0,0-2.905-5.446-5.448-2.905c-2.545,2.545-6.538,3.266-5.811,9.085 c0.733,5.807-7.991,4.358,1.453,9.804c8.756,5.049,6.398,7.576,12.922,7.92c0,0.022-0.014,0.05-0.014,0.072 c0,1.83,0.711,3.438,1.717,4.819c-0.453,1.03-0.721,2.142-0.721,3.338c0,2.952,1.633,5.432,3.963,6.909 c-1.843,1.521-3.186,3.2-2.787,4.733c1.1,4.173,7.137,37.964,7.137,37.964s18.105,35.844,10.353,55.699 c-7.746,19.861-59.087,109.465-68.286,131.261c-9.205,21.789-20.344,66.359-28.09,89.113 c-7.747,22.771-21.313,48.919-25.185,58.128c-3.879,9.197,7.747,2.905,7.747,9.69c0,6.776,3.394,10.17,9.691,10.17 c6.294,0,11.626,0.485,17.919,5.33c6.298,4.846,12.106,9.201,19.865,7.751c7.747-1.455,37.295,6.776,39.712,12.587 c2.418,5.811,26.635,20.27,37.776,11.141c9.706-7.95,30.412-10.135,35.602-10.563c5.189,0.429,25.896,2.613,35.602,10.563 c11.141,9.129,35.357-5.33,37.774-11.141c2.412-5.811,31.967-14.042,39.718-12.587 C360.419,453.921,366.229,449.557,372.525,444.712z M296.521,21.85c1.311,2.787,3.759,5.202,7.069,5.558 c0,0.054,0.04,0.101,0.04,0.165c0,1.012-0.317,1.914-0.77,2.753c-1.519-1.75-3.695-2.91-6.191-2.91 c-1.764,0-3.314,0.675-4.665,1.625c-0.12-0.479-0.297-0.944-0.297-1.46C291.707,24.691,293.799,22.399,296.521,21.85z M301.321,32.165c-1.03,0.81-2.248,1.365-3.659,1.365c-1.923,0-3.555-0.974-4.645-2.392c1.019-0.812,2.244-1.369,3.651-1.369 C298.584,29.769,300.224,30.743,301.321,32.165z M291.467,32.981c1.527,1.753,3.703,2.913,6.195,2.913 c1.771,0,3.314-0.677,4.669-1.625c0.124,0.479,0.301,0.94,0.301,1.461c0,2.438-1.487,4.528-3.587,5.448 c-2.869-1.917-5.951-3.312-5.951-3.312s-0.926-0.733-2.216-1.31c-0.044-0.285-0.168-0.529-0.168-0.818 C290.71,34.714,291.026,33.814,291.467,32.981z M175.522,27.573c0-0.058,0.034-0.11,0.034-0.165 c3.306-0.364,5.763-2.771,7.073-5.558c2.713,0.549,4.811,2.841,4.811,5.723c0,0.519-0.172,0.982-0.299,1.46 c-1.351-0.941-2.896-1.625-4.663-1.625c-2.495,0-4.672,1.163-6.193,2.91C175.845,29.486,175.522,28.585,175.522,27.573z M186.13,31.138c-1.09,1.418-2.723,2.392-4.646,2.392c-1.399,0-2.629-0.555-3.653-1.365c1.092-1.422,2.725-2.396,4.648-2.396 C183.884,29.769,185.118,30.326,186.13,31.138z M188.271,36.556c-1.288,0.585-2.22,1.31-2.22,1.31s-3.078,1.395-5.945,3.312 c-2.1-0.919-3.586-3.009-3.586-5.448c0-0.521,0.176-0.982,0.298-1.461c1.353,0.94,2.897,1.625,4.665,1.625 c2.494,0,4.668-1.16,6.195-2.913c0.443,0.833,0.757,1.745,0.757,2.757C188.436,36.019,188.314,36.271,188.271,36.556z"></path>
              </g>
            </g>
          </g>
        </svg>
      ),
    },
    {
      name: "وسیله نقلیه",
      id: "vehicle,motorcycle",
      icon: (
        <svg version="1.1" id="Capa_1" width="24" height="24" viewBox="0 0 467.168 467.168">
          <g id="SVGRepo_bgCarrier" strokeWidth="0"></g>
          <g id="SVGRepo_tracerCarrier" strokeLinecap="round" strokeLinejoin="round"></g>
          <g id="SVGRepo_iconCarrier">
            <g>
              <g>
                <path d="M76.849,210.531C34.406,210.531,0,244.937,0,287.388c0,42.438,34.406,76.847,76.849,76.847 c30.989,0,57.635-18.387,69.789-44.819l18.258,14.078c0,0,134.168,0.958,141.538-3.206c0,0-16.65-45.469,4.484-64.688 c2.225-2.024,5.021-4.332,8.096-6.777c-3.543,8.829-5.534,18.45-5.534,28.558c0,42.446,34.403,76.846,76.846,76.846 c42.443,0,76.843-34.415,76.843-76.846c0-42.451-34.408-76.849-76.843-76.849c-0.697,0-1.362,0.088-2.056,0.102 c5.551-3.603,9.093-5.865,9.093-5.865l-5.763-5.127c0,0,16.651-3.837,12.816-12.167c-3.848-8.33-44.19-58.28-44.19-58.28 s7.146-15.373-7.634-26.261l-7.098,15.371c0,0-18.093-12.489-25.295-10.084c-7.205,2.398-18.005,3.603-21.379,8.884l-3.358,3.124 c0,0-0.95,5.528,4.561,13.693c0,0,55.482,17.05,58.119,29.537c0,0,3.848,7.933-12.728,9.844l-3.354,4.328l-8.896,0.479 l-16.082-36.748c0,0-15.381,4.082-23.299,10.323l1.201,6.24c0,0-64.599-43.943-125.362,21.137c0,0-44.909,12.966-76.37-26.897 c0,0-0.479-12.968-76.367-10.565l5.286,5.524c0,0-5.286,0.479-7.444,3.841c-2.158,3.358,1.2,6.961,18.494,6.961 c0,0,39.153,44.668,69.17,42.032l42.743,20.656l18.975,32.42c0,0,0.034,2.785,0.23,7.045c-4.404,0.938-9.341,1.979-14.579,3.09 C139.605,232.602,110.832,210.531,76.849,210.531z M390.325,234.081c29.395,0,53.299,23.912,53.299,53.299 c0,29.39-23.912,53.294-53.299,53.294c-29.394,0-53.294-23.912-53.294-53.294C337.031,257.993,360.932,234.081,390.325,234.081z M76.849,340.683c-29.387,0-53.299-23.913-53.299-53.295c0-29.395,23.912-53.299,53.299-53.299 c22.592,0,41.896,14.154,49.636,34.039c-28.26,6.011-56.31,11.99-56.31,11.99l3.619,19.933l55.339-2.444 C124.365,322.116,102.745,340.683,76.849,340.683z M169.152,295.835c1.571,5.334,3.619,9.574,6.312,11.394l-24.696,0.966 c1.058-3.783,1.857-7.666,2.338-11.662L169.152,295.835z"></path>
              </g>
            </g>
          </g>
        </svg>
      ),
    },
  ];
  useEffect(() => {
    setLoading(true);
    let cats = category.split(",");
    Promise.all(cats.map((cat) => fetch(`https://dummyjson.com/products/category/${cat}`).then((res) => res.json()))).then((results) => {
      const merged = results.flatMap((r) => r.products);
      setProducts(merged);
      setTimeout(() => {
        setLoading(false);
      }, 200);
    });
  }, [category]);
  return (
    <div className="min-h-screen">
      <Swiper className="top-categories mx-auto text-gray fill-gray text-sm md:text-base" slidesPerView={"auto"} spaceBetween={15} centeredSlides={false}>
        {categories.map((cat) => (
          <SwiperSlide key={cat.id} className=" w-auto! py-2">
            <TopCategoriesBtn key={cat.id} name={cat.name} id={cat.id} category={category} onCategory={(cat) => setCategory(cat)} icon={cat.icon} />
          </SwiperSlide>
        ))}
      </Swiper>
      {loading ? (
        <div className="my-25  text-center">
          <div className="inline-block size-12 animate-spin rounded-full border-6 border-light-gray/40 border-t-red"></div>
        </div>
      ) : (
        <div>
          <Swiper
            className="w-full top-categories-product-swiper py-4! md:py-8! select-none"
            slidesPerView={"auto"}
            modules={[FreeMode]}
            freeMode={{
              enabled: true,
              momentum: true,
            }}
          >
            <SwiperSlide className="w-full! my-2 ">
              <div className="grid! grid-cols-6 gap-4 md:gap-y-6">
                {[...products].splice(0, 12).map((product) => (
                  <div key={product.id} className="w-53! shrink-0">
                    <ProductCart product={product} />
                  </div>
                ))}
              </div>
            </SwiperSlide>
          </Swiper>
          {products.length > 12 && (
            <div className="text-center py-3 lg:py-4">
              <Link to={`/shop?categories=${category}`} className="py-2 px-10 rounded-full gradient text-white transition-[scale_box-shaddow] duration-300 inline-block hover:scale-110 hover:shadow-[-2px_0px_8px_#ff3b00b5]">
                مشاهده همه
              </Link>
            </div>
          )}
        </div>
      )}
    </div>
  );
}
